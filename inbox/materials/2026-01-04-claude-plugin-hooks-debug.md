---
title: "Claude Code 플러그인 Hooks 검증 요약"
date: 2026-01-04
source: "perplexity 대화 + 로컬 디버깅"
type: conversation
status: raw
---

# Claude Code 플러그인 Hooks 검증 요약 (대화 맥락)

## 발단(Problem)
- Claude plugin을 설치했지만, 플러그인 hooks가 기대대로 동작하지 않는 것으로 보임.
- 원인이 (1) 플러그인 구현 규칙 미준수 또는 (2) 트리거/매처 조건 오해 또는 (3) 설정/세션 반영 문제일 수 있음.

## 의사결정 과정(Decision flow)
1. 먼저 "hooks가 어떻게 동작하는지"를 개념적으로 정리해, 기대 동작(언제/무엇이 실행되어야 하는지)을 명확히 함.
2. 그 다음 "공식 문서 기준 구현 규칙"을 확인해, 플러그인 훅 파일 위치/포맷/이벤트/매처 규칙에서 실수 가능 지점을 추림.
3. 마지막으로 "로컬 작업 디렉토리에서 재현 가능한 검증 절차"를 만들어,
   - (A) 훅이 로드되는지
   - (B) 이벤트 트리거가 발생하는지
   - (C) 매처가 일치하는지
   - (D) 커맨드가 실제 실행되는지
   를 단계적으로 분리해서 확인하기로 함.

## 핵심 포인트(Key points)
- 훅은 Claude Code의 특정 이벤트(예: PreToolUse/PostToolUse/Stop 등)에 맞춰 커맨드를 자동 실행하는 트리거 방식임.
- 플러그인 내부 훅 파일(`hooks/hooks.json`)과 프로젝트/유저 설정의 훅 포맷은 동일하지 않을 수 있어 포맷 혼동이 흔함.
- 매처는 대소문자/Tool 이름 불일치 등으로 "0회 실행"이 쉽게 발생함.
- 훅/설정을 바꾼 뒤 세션 재시작을 하지 않으면 반영이 안 된 것처럼 보일 수 있음.
- `claude --debug` 및 훅/플러그인 관련 커맨드(예: /hooks)를 통해 "로드/실행 여부"를 로그로 확인하는 게 가장 빠름.

## 최소 검증 절차(로컬에서 바로 재현)
1. 프로젝트 루트에서 실행
   - `cd /path/to/project && claude`
2. 플러그인 설치/활성화 확인
   - (가능하면) 설치 직후 훅이 로드되었는지 확인
3. 훅 트리거를 강제로 발생
   - PreToolUse 훅이면 Bash 실행을 유도(예: `ls` 실행 요청)
   - PostToolUse 훅이면 파일 Write/Edit가 발생하도록 요청
4. 훅 결과를 "관측 가능한 출력"으로 확인
   - 로그 파일 생성
   - 특정 파일 변경
   - 알림/메시지
5. 디버그 모드로 원인 분리
   - `claude --debug`로 훅 로딩/실행 로그 확인

## 문제 원인 후보(우선순위)
- 포맷 문제: 플러그인 `hooks/hooks.json` 구조가 요구사항과 다름
- 설정 미적용: 프로젝트/유저 settings 경로 또는 포맷 혼동
- 매처 오류: tool name, glob, case-sensitive 등 불일치
- 실행 환경 문제: 스크립트 권한(+x), 경로, 의존 커맨드 누락
- 세션 이슈: 훅 변경 후 Claude 세션 재시작 누락

## 다음 액션(요청할 정보)
아래 3가지만 확보하면 대부분 1~2번의 수정으로 해결 가능:
1. 플러그인 `hooks/hooks.json` 내용(비밀값 제외)
2. 프로젝트 `.claude/settings.json`의 plugins/hook 관련 부분
3. `claude --debug` 실행 시 훅 로딩/실행 관련 로그 일부
